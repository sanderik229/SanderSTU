{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å ‚Äî SanderStu</title>
    <link rel="stylesheet" href="{% static 'shop/css/styles.css' %}">
    <link rel="stylesheet" href="{% static 'shop/css/admin.css' %}">
</head>
<body>
<main class="admin-dashboard">
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <div class="admin-logo">
                <h2>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
            </div>
            <nav class="admin-nav">
                <ul>
                    <li><a href="#dashboard" class="nav-item active" data-section="dashboard">
                        <span class="nav-icon">üìä</span> –ì–ª–∞–≤–Ω–∞—è
                    </a></li>
                    <li><a href="#services" class="nav-item" data-section="services">
                        <span class="nav-icon">üõçÔ∏è</span> –£—Å–ª—É–≥–∏
                    </a></li>
                    <li><a href="#orders" class="nav-item" data-section="orders">
                        <span class="nav-icon">üìã</span> –ó–∞–∫–∞–∑—ã
                    </a></li>
                    <li><a href="#users" class="nav-item" data-section="users">
                        <span class="nav-icon">üë•</span> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
                    </a></li>
                    <li><a href="#analytics" class="nav-item" data-section="analytics">
                        <span class="nav-icon">üìà</span> –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
                    </a></li>
                    <li><a href="#reports" class="nav-item" data-section="reports">
                        <span class="nav-icon">üìÑ</span> –û—Ç—á–µ—Ç—ã
                    </a></li>
                    <li><a href="#settings" class="nav-item" data-section="settings">
                        <span class="nav-icon">‚öôÔ∏è</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                    </a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="admin-main">
            <!-- Header -->
            <header class="admin-header">
                <div class="admin-header-left">
                    <h1 id="page-title">–î–∞—à–±–æ—Ä–¥</h1>
                    <p id="page-subtitle">–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã –∏ –∫–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</p>
                </div>
                <div class="admin-header-right">
                    <div class="admin-user">
                        <span class="user-name" id="adminUserName">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</span>
                        <div class="user-menu">
                            <button class="user-menu-btn">‚öôÔ∏è</button>
                            <div class="user-dropdown">
                                <a href="#" id="logoutAdmin">–í—ã–π—Ç–∏</a>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Dashboard Content -->
            <div class="admin-content" id="admin-content">
                <!-- KPI Cards -->
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-icon">üí∞</div>
                        <div class="kpi-content">
                            <h3>–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞</h3>
                            <div class="kpi-value" id="totalRevenue">0 ‚ÇΩ</div>
                            <div class="kpi-change positive">+12.5%</div>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-icon">üì¶</div>
                        <div class="kpi-content">
                            <h3>–ó–∞–∫–∞–∑—ã –∑–∞ –º–µ—Å—è—Ü</h3>
                            <div class="kpi-value" id="monthlyOrders">0</div>
                            <div class="kpi-change positive">+8.2%</div>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-icon">üë•</div>
                        <div class="kpi-content">
                            <h3>–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                            <div class="kpi-value" id="activeUsers">0</div>
                            <div class="kpi-change positive">+15.3%</div>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-icon">üìä</div>
                        <div class="kpi-content">
                            <h3>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</h3>
                            <div class="kpi-value" id="averageOrder">0 ‚ÇΩ</div>
                            <div class="kpi-change negative">-2.1%</div>
                        </div>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="charts-row">
                    <div class="chart-container">
                        <h3>–í—ã—Ä—É—á–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º</h3>
                        <canvas id="revenueChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏</h3>
                        <canvas id="servicesChart"></canvas>
                    </div>
                </div>

                <!-- Recent Orders -->
                <div class="recent-section">
                    <div class="section-header">
                        <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</h3>
                        <a href="#orders" class="view-all">–í—Å–µ –∑–∞–∫–∞–∑—ã ‚Üí</a>
                    </div>
                    <div class="recent-orders" id="recentOrders">
                        <!-- Orders will be loaded here -->
                    </div>
                </div>

                <!-- Notifications -->
                <div class="notifications-section">
                    <div class="section-header">
                        <h3>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                        <span class="notification-count" id="notificationCount">0</span>
                    </div>
                    <div class="notifications" id="notifications">
                        <!-- Notifications will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Services Section -->
            <section id="services" class="admin-section">
                <div class="section-header">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏</h3>
                    <button class="btn btn-primary" onclick="adminDashboard.addService()">–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É</button>
                </div>
                <div class="services-grid" id="servicesGrid">
                    <!-- Services will be loaded here -->
                </div>
            </section>

            <!-- Orders Section -->
            <section id="orders" class="admin-section">
                <div class="section-header">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</h3>
                    <div class="filters">
                        <select id="orderStatusFilter">
                            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="new">–ù–æ–≤—ã–π</option>
                            <option value="paid">–û–ø–ª–∞—á–µ–Ω</option>
                            <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                            <option value="done">–í—ã–ø–æ–ª–Ω–µ–Ω</option>
                            <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω</option>
                        </select>
                        <input type="text" id="orderSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∑–∞–∫–∞–∑–∞–º...">
                        <button class="btn btn-primary">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                    </div>
                </div>
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>–ö–ª–∏–µ–Ω—Ç</th>
                                <th>–£—Å–ª—É–≥–∞</th>
                                <th>–¢–∏–ø</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–î–∞—Ç–∞</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTable">
                            <!-- Orders will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Users Section -->
            <section id="users" class="admin-section">
                <div class="section-header">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                    <button class="btn btn-primary" onclick="adminDashboard.addUser()">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
                    <div class="filters">
                        <select id="userRoleFilter">
                            <option value="">–í—Å–µ —Ä–æ–ª–∏</option>
                            <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                            <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                        </select>
                        <input type="text" id="userSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º...">
                        <button class="btn btn-primary">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                    </div>
                </div>
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Email</th>
                                <th>–§–ò–û</th>
                                <th>–†–æ–ª—å</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable">
                            <!-- Users will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Analytics Section -->
            <section id="analytics" class="admin-section">
                <div class="section-header">
                    <h3>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <div class="filters">
                        <select id="analyticsPeriod">
                            <option value="month">–ú–µ—Å—è—Ü</option>
                            <option value="week">–ù–µ–¥–µ–ª—è</option>
                            <option value="day">–î–µ–Ω—å</option>
                        </select>
                        <select id="analyticsCategory">
                            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                        </select>
                        <button class="btn btn-primary">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                    </div>
                </div>
                <div class="analytics-grid">
                    <div class="chart-container">
                        <h3>–í—ã—Ä—É—á–∫–∞ –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º</h3>
                        <canvas id="analyticsRevenueChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                        <canvas id="analyticsUsersChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="admin-section">
                <div class="section-header">
                    <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
                    <button class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </div>
                <div class="settings-grid">
                    <div class="setting-card">
                        <h4>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                        <label>Email –∫–æ–º–ø–∞–Ω–∏–∏<input type="email" value="info@sanderstu.com"></label>
                        <label>–¢–µ–ª–µ—Ñ–æ–Ω –∫–æ–º–ø–∞–Ω–∏–∏<input type="tel" value="+7 (495) 123-45-67"></label>
                    </div>
                    <div class="setting-card">
                        <h4>–°–∏—Å—Ç–µ–º–∞</h4>
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ<input type="text" value="SanderStu"></label>
                        <label>–û–ø–∏—Å–∞–Ω–∏–µ<textarea>SanderStu - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º—ã —É –±–ª–æ–≥–µ—Ä–æ–≤</textarea></label>
                    </div>
                </div>
            </section>

            <!-- Reports Section -->
            <section id="reports" class="admin-section">
                <div class="section-header">
                    <h3>–û—Ç—á–µ—Ç—ã –∏ —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
                    <div class="filters">
                        <select id="reportPeriod">
                            <option value="month">–ú–µ—Å—è—Ü</option>
                            <option value="year">–ì–æ–¥</option>
                        </select>
                        <button class="btn btn-primary" onclick="adminDashboard.generateMonthlyReport()">–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç</button>
                        <button class="btn btn-secondary" onclick="adminDashboard.exportOrders('csv')">–≠–∫—Å–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤</button>
                        <button class="btn btn-secondary" onclick="adminDashboard.exportUsers('csv')">–≠–∫—Å–ø–æ—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
                        <button class="btn btn-secondary" onclick="adminDashboard.exportServices('csv')">–≠–∫—Å–ø–æ—Ä—Ç —É—Å–ª—É–≥</button>
                    </div>
                </div>
                <div class="reports-grid">
                    <div class="report-card">
                        <h4>–ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –æ—Ç—á–µ—Ç</h4>
                        <p>–ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –æ –ø—Ä–æ–¥–∞–∂–∞—Ö, –∑–∞–∫–∞–∑–∞—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü.</p>
                        <button class="btn btn-primary" onclick="adminDashboard.generateMonthlyReport()">–°–∫–∞—á–∞—Ç—å</button>
                    </div>
                    <div class="report-card">
                        <h4>–û—Ç—á–µ—Ç –ø–æ —É—Å–ª—É–≥–∞–º</h4>
                        <p>–î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –∏ –≤—ã—Ä—É—á–∫–µ –æ—Ç –∫–∞–∂–¥–æ–π —É—Å–ª—É–≥–∏.</p>
                        <button class="btn btn-primary" onclick="adminDashboard.exportServices('csv')">–°–∫–∞—á–∞—Ç—å</button>
                    </div>
                </div>
            </section>
        </div>
    </div>
</main>

<!-- Toast Notifications -->
<div id="adminToast" class="admin-toast"></div>

<!-- Orders Modal -->
<div id="ordersModal" class="modal" style="display: none;">
    <div class="modal-backdrop" onclick="closeOrdersModal()"></div>
    <div class="modal-dialog modal-large">
        <div class="modal-header">
            <h3>–í—Å–µ –∑–∞–∫–∞–∑—ã</h3>
            <button class="modal-close" onclick="closeOrdersModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="orders-table-container" id="ordersTableContainer">
                <!-- Orders will be loaded here -->
            </div>
        </div>
    </div>
</div>

<!-- Status Change Modal -->
<div id="statusModal" class="modal" style="display: none;">
    <div class="modal-backdrop" onclick="closeStatusModal()"></div>
    <div class="modal-dialog">
        <div class="modal-header">
            <h3>–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞</h3>
            <button class="modal-close" onclick="closeStatusModal()">&times;</button>
        </div>
        <div class="modal-body">
            <form id="statusChangeForm">
                <input type="hidden" id="statusOrderId" name="order_id">
                <label>–ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å:
                    <select id="newStatus" name="status" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç—É—Å</option>
                        <option value="new">–ù–æ–≤—ã–π</option>
                        <option value="paid">–û–ø–ª–∞—á–µ–Ω</option>
                        <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                        <option value="done">–í—ã–ø–æ–ª–Ω–µ–Ω</option>
                        <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω</option>
                    </select>
                </label>
                <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{% static 'shop/js/admin.js' %}?v=2"></script>
</body>
</html>
