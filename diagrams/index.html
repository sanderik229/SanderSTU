<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SanderStu - –°–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
        }
        
        .tab-button {
            background: white;
            border: none;
            padding: 12px 24px;
            cursor: pointer;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .tab-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }
        
        .tab-button.active {
            background: #4CAF50;
            color: white;
        }
        
        .diagram-container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            min-height: 600px;
            display: none;
        }
        
        .diagram-container.active {
            display: block;
        }
        
        .diagram-title {
            font-size: 2em;
            color: #333;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .diagram-description {
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .mermaid {
            text-align: center;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
        }
        
        footer {
            text-align: center;
            color: white;
            margin-top: 30px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ SanderStu - –°–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã</h1>
            <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º–æ–π</p>
        </header>
        
        <div class="tabs">
            <button class="tab-button active" onclick="showDiagram('architecture')">–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</button>
            <button class="tab-button" onclick="showDiagram('er')">ER-–¥–∏–∞–≥—Ä–∞–º–º–∞</button>
            <button class="tab-button" onclick="showDiagram('class')">–î–∏–∞–≥—Ä–∞–º–º–∞ –∫–ª–∞—Å—Å–æ–≤</button>
            <button class="tab-button" onclick="showDiagram('flow')">–ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö</button>
        </div>
        
        <div id="architecture" class="diagram-container active">
            <h2 class="diagram-title">–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è —Å—Ö–µ–º–∞ —Å–∏—Å—Ç–µ–º—ã</h2>
            <p class="diagram-description">
                –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ SanderStu –≤–∫–ª—é—á–∞–µ—Ç Frontend Layer, Authentication Layer, API Layer, 
                Application Layer, Data Layer –∏ Services Layer
            </p>
            <div class="mermaid">
graph TB
    subgraph "Frontend Layer"
        A[–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞<br/>home.html]
        B[–ö–∞—Ç–∞–ª–æ–≥ —Ä–µ–∫–ª–∞–º—ã<br/>buy.html]
        C[–ó–∞–∫–∞–∑ —Ä–µ–∫–ª–∞–º—ã<br/>order.html]
        D[–ü—Ä–æ—Ñ–∏–ª—å<br/>profile.html]
        E[–ú–æ–∏ –∑–∞–∫–∞–∑—ã<br/>my_orders.html]
        F[–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å<br/>admin_dashboard.html]
        G[–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–Ω–µ–ª—å<br/>dashboard.html]
    end

    subgraph "Authentication Layer"
        H[Login Modal]
        I[Registration Modal]
        J[JWT Authentication]
    end

    subgraph "API Layer"
        K["/api/v2/offers/"]
        L["/api/v2/orders/"]
        M["/api/v2/auth/"]
        N["/api/v2/me/"]
        O["/admin/..."]
        P["/manager/api/..."]
    end

    subgraph "Application Layer"
        Q[Django REST Framework]
        R[JWT Middleware]
        S[Manager Middleware]
    end

    subgraph "Business Logic Layer"
        T[Views]
        U[Serializers]
        V[Permissions]
    end

    subgraph "Data Layer"
        W[Models]
        X[PostgreSQL Database]
        Y[Media Files]
        Z[Static Files]
    end

    subgraph "Services Layer"
        AA[Seed Data Service]
        BB[Report Generation]
        CC[PDF Export]
    end

    A --> H
    A --> I
    H --> J
    I --> J
    
    B --> K
    C --> L
    A --> N
    F --> O
    G --> P
    
    K --> Q
    L --> Q
    M --> Q
    N --> Q
    O --> R
    P --> S
    
    Q --> T
    T --> U
    T --> V
    V --> W
    
    W --> X
    W --> Y
    W --> Z
    
    T --> AA
    T --> BB
    T --> CC
            </div>
        </div>
        
        <div id="er" class="diagram-container">
            <h2 class="diagram-title">ER-–¥–∏–∞–≥—Ä–∞–º–º–∞ (–õ–æ–≥–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å)</h2>
            <p class="diagram-description">
                Entity-Relationship –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ —Å—É—â–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –Ω–∏–º–∏
            </p>
            <div class="mermaid">
erDiagram
    User ||--o{ Profile : has
    User ||--o{ Manager : has
    User ||--o{ Order : places
    User ||--o{ Review : writes
    User ||--o{ Transaction : makes
    
    Profile ||--|| User : belongs_to
    
    Manager ||--o{ Blogger : manages
    Manager ||--o{ AdService : creates
    Manager ||--o{ ManagerOrder : handles
    Manager ||--o{ WeeklyReport : generates
    Manager ||--o{ Notification : receives
    
    Blogger ||--o{ AdOffer : offers
    Blogger ||--o{ AdService : has
    Blogger ||--o{ Review : receives
    
    AdOffer ||--o{ Order : generates
    AdOffer ||--o{ Review : has
    
    AdService ||--|| Blogger : belongs_to
    AdService ||--|| Manager : created_by
    
    Order ||--o| ManagerOrder : may_create
    Order ||--o{ Transaction : has
    Order ||--o| AdOffer : references
    
    ManagerOrder ||--|| Manager : assigned_to
    
    WeeklyReport ||--|| Manager : belongs_to
    
    Notification ||--|| Manager : belongs_to
    
    Transaction ||--|| Order : belongs_to
    Transaction ||--|| User : made_by
    
    Review ||--|| User : written_by
    Review ||--|| Blogger : about
    Review ||--o| AdOffer : references
            </div>
        </div>
        
        <div id="class" class="diagram-container">
            <h2 class="diagram-title">–î–∏–∞–≥—Ä–∞–º–º–∞ –∫–ª–∞—Å—Å–æ–≤</h2>
            <p class="diagram-description">
                –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã —Å–∏—Å—Ç–µ–º—ã –∏ –∏—Ö –∞—Ç—Ä–∏–±—É—Ç—ã, –º–µ—Ç–æ–¥—ã –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è
            </p>
            <div class="mermaid">
classDiagram
    class User {
        +String username
        +String email
        +String first_name
        +String last_name
        +Boolean is_staff
        +Boolean is_superuser
        +DateTime date_joined
    }

    class Profile {
        +String full_name
        +Integer birth_year
        +String role
        +String card_last4
        +User user
    }

    class Manager {
        +String phone
        +String department
        +Date hire_date
        +Boolean is_active
        +User user
    }

    class Blogger {
        +String name
        +String social_network
        +String topic
        +Integer audience_size
        +Manager manager
    }

    class AdOffer {
        +String title
        +String description
        +Decimal price
        +String social_network
        +Boolean is_active
        +DateTime created_at
        +Blogger blogger
    }

    class AdService {
        +String name
        +String social_network
        +Decimal price
        +String description
        +Boolean is_active
        +Blogger blogger
        +Manager manager
    }

    class Order {
        +String order_type
        +String status
        +String payment_status
        +Decimal payment_amount
        +User user
        +AdOffer offer
    }

    class ManagerOrder {
        +String order_type
        +String status
        +String client_name
        +String client_email
        +String service_description
        +Decimal budget
        +Manager manager
        +Order blogger_order
    }

    class Review {
        +Integer rating
        +String text
        +DateTime created_at
        +User user
        +Blogger blogger
        +AdOffer offer
    }

    class WeeklyReport {
        +Date week_start
        +Date week_end
        +Integer total_orders
        +Decimal total_revenue
        +Integer active_services
        +File pdf_file
        +Manager manager
    }

    User ||--|| Profile : has
    User ||--o| Manager : has
    Manager ||--o{ Blogger : manages
    Blogger ||--o{ AdOffer : has
    Manager ||--o{ AdService : creates
    Blogger ||--o{ AdService : has
    Manager ||--o{ ManagerOrder : manages
    User ||--o{ Order : makes
    AdOffer ||--o{ Order : generates
    Order ||--o{ ManagerOrder : creates
    AdOffer ||--o{ Review : has
    Blogger ||--o{ Review : receives
    Manager ||--o{ WeeklyReport : generates
            </div>
        </div>
        
        <div id="flow" class="diagram-container">
            <h2 class="diagram-title">–ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Å–∏—Å—Ç–µ–º–µ</h2>
            <p class="diagram-description">
                –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–∏ –∑–∞–∫–∞–∑–µ —Ä–µ–∫–ª–∞–º—ã –∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–∫–∞–∑–æ–≤
            </p>
            <div class="mermaid">
sequenceDiagram
    participant U as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant F as Frontend
    participant API as API Layer
    participant M as Models
    participant DB as PostgreSQL
    participant MG as –ú–µ–Ω–µ–¥–∂–µ—Ä
    participant ADM as –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä

    Note over U,DB: –ó–∞–∫–∞–∑ —Ä–µ–∫–ª–∞–º—ã (–ü–æ—Ç–æ–∫ 1)
    U->>F: –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –∫–∞—Ç–∞–ª–æ–≥
    F->>API: GET /api/v2/offers/
    API->>M: AdOffer.objects.all()
    M->>DB: SELECT * FROM bloggers_adoffer
    DB-->>M: –î–∞–Ω–Ω—ã–µ
    M-->>API: JSON
    API-->>F: –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
    F-->>U: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–∞—Ç–∞–ª–æ–≥
    
    U->>F: –ù–∞–∂–∏–º–∞–µ—Ç "–ó–∞–∫–∞–∑–∞—Ç—å"
    F->>API: POST /api/v2/orders/
    API->>M: Order.objects.create()
    M->>DB: INSERT INTO ads_order
    M->>DB: INSERT INTO managers_managerorder
    DB-->>M: OK
    M-->>API: Order created
    API-->>F: Success
    F-->>U: –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω

    Note over MG,DB: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–∞ (–ü–æ—Ç–æ–∫ 2)
    MG->>F: –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–∞–Ω–µ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞
    F->>API: GET /manager/api/orders/personal_orders/
    API->>M: ManagerOrder.objects.filter(manager=user)
    M->>DB: SELECT —Å JOIN
    DB-->>M: –ó–∞–∫–∞–∑—ã
    M-->>API: JSON
    API-->>F: –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤
    F-->>U: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∑–∞–∫–∞–∑—ã
    
    MG->>F: –ù–∞–∂–∏–º–∞–µ—Ç "–ü—Ä–∏–Ω—è—Ç—å"
    F->>API: POST /manager/api/orders/1/accept/
    API->>M: status = 'accepted'
    M->>DB: UPDATE managers_managerorder
    DB-->>M: OK
    M-->>API: Success
    API-->>F: OK
    F-->>U: –ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç

    Note over ADM,DB: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ (–ü–æ—Ç–æ–∫ 3)
    ADM->>F: –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
    F->>API: GET /api/v2/admin/stats/
    API->>M: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    M->>DB: –°–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
    DB-->>M: –î–∞–Ω–Ω—ã–µ
    M-->>API: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    API-->>F: JSON
    F-->>ADM: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            </div>
        </div>
        
        <footer>
            <p>¬© 2025 SanderStu - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º–æ–π</p>
        </footer>
    </div>
    
    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose'
        });
        
        function showDiagram(diagramId) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
            const containers = document.querySelectorAll('.diagram-container');
            containers.forEach(container => {
                container.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∏–∞–≥—Ä–∞–º–º—É
            document.getElementById(diagramId).classList.add('active');
            
            // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(button => {
                button.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å –¥–∏–∞–≥—Ä–∞–º–º—É
            setTimeout(() => {
                mermaid.init(undefined, document.querySelector('#' + diagramId + ' .mermaid'));
            }, 100);
        }
    </script>
</body>
</html>
